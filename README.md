# 概要
銀行、証券会社のWebサイトをスクレイピングして、資産情報を集めるプログラム。
集めた明細データは、Googleスプレッドシートへ保存する。
複数口座に分かれた自分の資産や、家族と合算した場合の残高を把握するために作成した。
同じようなことは巷の家計簿サービスにもある。

# アウトプット
スクリプトを実行した日付ごとの資産残高明細データ。

## 残高明細
そのとき集めた資産の一覧。分類ごとにまとめず、株なら銘柄ごとに記録する。

|列名|説明|
|---|---|
|日付|実行した日付|
|所有者|口座の持ち主。複数人の口座残高を集めて、所有者ごとの集計を把握したいときに利用する。|
|分類|日本株式、海外株式など、あらかじめ決めておいた分類。項目と分類の対照表はスプレッドシートへ定義しておく。|
|口座|銀行、証券会社の名前。|
|項目|詳細の名前。銘柄名など。|
|金額||

# 分類変換表
残高明細の分類は項目名から決まる。その対照表は、残高明細を記録するスプレッドシートと同ファイルに定義しておく。

|列名|説明|
|---|---|
|分類|国内株式、投資信託など、個別の資産の分類。|
|パターン|個別の資産名。正規表現が使える。|

# 設定
config を使ってjson形式で定義する。
pattern の表記は正規表現で指定する。

```json
{
    "spreadsheets" :{
        "sheetId" : "xxxxx"
        , "range" : "明細"
    }
    , "accounts" : [
        {
            "name" : "ufj", "user_id" : "xxxx", "password" : "pass", "branch" : "999"
            , "owner" : "Aさん"
            , "aggregate" : [
                {"group" : "現金", "pattern" : ".*"}
            ]
        }
        ,{
            "name" : "rakuten_stock", "user_id" : "xxxx", "password" : "pass"
            , "owner" : "Bさん"
            , "aggregate" : [
                {"group" : "日本株式", "pattern" : "ソフトバンク.*"}
            ]
        }
    ]
    // 分類の名前。ここで定義した順番で分類別集計が出力される。
    , "groups" : ["現金", "日本株式", "海外株式", "投資信託(国内)", "投資信託(海外)", "不明"]

    // csvファイルの出力先
    , "destination_detail" : "output/detail.csv"
    , "destination_total" : "output/total.csv"
}
```

※ 実際のJSONはコメント行を許可しないので注意。

# 変更点

* 明細データに所有者を追加。
 * 列は以下の通り：日付(date)、所有者(owner)、分類(group)、口座(account)、項目名(name)、金額(amount)
 * 所有者は設定ファイルで定義する。
* 名寄せパターンはスプレッドシートに載せて、スクリプトで取得して使う。